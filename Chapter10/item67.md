# 67 過剰な同期は避ける

過剰な同期はパフォーマンス低下・デッドロック・予想もつかない振る舞いをもたらすので避けなければならない。

## 同期されたメソッドやブロック内で、制御をクライアントに譲ってはダメ
オブザーバーパターンの例。<br>synchronizedブロックの中で外部から渡されたオブジェクトのメソッドを呼び出した結果、例外が発生したり、デッドロックが発生したりする。

一般に、同期された領域内では出来る限り少ない処理を行うべき。

過剰な同期を行うことで、並行処理を行う機会が失われることが本当の損失！！<br>今日のマルチコア時代では、過剰に同期しないことがこれまで以上に重要。

並行して使用されるクラスはスレッドセーフしてドキュメントに記載すべきだが、そうでない場合は内部的に同期しない方が良い。

## 余談
+ 同期された領域外で呼び出される異質なメソッドはオープンコール(open call)と呼ばれる。
+ [CopyOnWriteArrayList](https://docs.oracle.com/javase/jp/8/api/java/util/concurrent/CopyOnWriteArrayList.html)は通常非常に効率が悪いが、ArrayListのスレッドセーフ版として使えそう。<br>イテレータはイテレータ作成以降のリストへの追加・削除・変更を反映しない。
